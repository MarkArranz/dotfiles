#!/usr/bin/env bash

CONFIG_DIR="$HOME/.config/sketchybar"

# Build and start the C helper for CPU monitoring
killall helper 2>/dev/null
(cd "$CONFIG_DIR/helper" && make) >/dev/null 2>&1
"$CONFIG_DIR/helper/helper" git.felix.helper >/dev/null 2>&1 &

# Unload macOS volume overlay
launchctl unload -F /System/Library/LaunchAgents/com.apple.OSDUIHelper.plist >/dev/null 2>&1 &

# Run the Lua configuration
cd "$CONFIG_DIR"
lua init.lua
